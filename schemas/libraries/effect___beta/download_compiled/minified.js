const e=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let n=e;for(let e=0,r=t.length;e<r;e++)n=t[e](n);return n}}},t=class{pipe(){return e(this,arguments)}},n=function(e,t){if(typeof e==`function`)return function(){return e(arguments)?t.apply(this,arguments):e=>t(e,...arguments)};switch(e){case 0:case 1:throw RangeError(`Invalid arity ${e}`);case 2:return function(e,n){return arguments.length>=2?t(e,n):function(n){return t(n,e)}};case 3:return function(e,n,r){return arguments.length>=3?t(e,n,r):function(r){return t(r,e,n)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let n=arguments;return function(e){return t(e,...n)}}}},r=e=>e,i=e=>()=>e,a=i(!1),o=i(void 0),s=o;function c(e){let t=new WeakMap;return n=>{if(t.has(n))return t.get(n);let r=e(n);return t.set(n,r),r}}const l=e=>{let t=new Set(Reflect.ownKeys(e));if(e.constructor===Object)return t;e instanceof Error&&t.delete(`stack`);let n=Object.getPrototypeOf(e),r=n;for(;r!==null&&r!==Object.prototype;){let e=Reflect.ownKeys(r);for(let n=0;n<e.length;n++)t.add(e[n]);r=Object.getPrototypeOf(r)}return t.has(`constructor`)&&typeof e.constructor==`function`&&n===e.constructor.prototype&&t.delete(`constructor`),t},u=new WeakSet;function d(e){return typeof e==`string`}function f(e){return typeof e==`number`}function p(e){return typeof e==`function`}function ee(e){return e!=null}function m(e){return typeof e==`object`&&!!e&&!Array.isArray(e)}function h(e){return typeof e==`object`&&!!e||p(e)}const g=n(2,(e,t)=>h(e)&&t in e),_=`~effect/interfaces/Hash`,v=e=>{switch(typeof e){case`number`:return ie(e);case`bigint`:return b(e.toString(10));case`boolean`:return b(String(e));case`symbol`:return b(String(e));case`string`:return b(e);case`undefined`:return b(`undefined`);case`function`:case`object`:if(e===null)return b(`null`);if(e instanceof Date)return b(e.toISOString());if(e instanceof RegExp)return b(e.toString());{if(u.has(e))return te(e);if(fe.has(e))return fe.get(e);let t=me(e,()=>re(e)?e[_]():typeof e==`function`?te(e):Array.isArray(e)?ce(e):e instanceof Map?le(e):e instanceof Set?ue(e):oe(e));return fe.set(e,t),t}default:throw Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},te=e=>(de.has(e)||de.set(e,ie(Math.floor(Math.random()*(2**53-1)))),de.get(e)),y=n(2,(e,t)=>e*53^t),ne=e=>e&3221225471|e>>>1&1073741824,re=e=>g(e,_),ie=e=>{if(e!==e)return b(`NaN`);if(e===1/0)return b(`Infinity`);if(e===-1/0)return b(`-Infinity`);let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return ne(t)},b=e=>{let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return ne(t)},ae=(e,t)=>{let n=12289;for(let r of t)n^=y(v(r),v(e[r]));return ne(n)},oe=e=>ae(e,l(e)),se=(e,t)=>n=>{let r=e;for(let e of n)r^=t(e);return ne(r)},ce=se(6151,v),le=se(b(`Map`),([e,t])=>y(v(e),v(t))),ue=se(b(`Set`),v),de=new WeakMap,fe=new WeakMap,pe=new WeakSet;function me(e,t){if(pe.has(e))return b(`[Circular]`);pe.add(e);let n=t();return pe.delete(e),n}const x=`~effect/interfaces/Equal`;function S(){return arguments.length===1?e=>C(e,arguments[0]):C(arguments[0],arguments[1])}function C(e,t){if(e===t)return!0;if(e==null||t==null)return!1;let n=typeof e;return n===typeof t?n===`number`&&e!==e&&t!==t?!0:n!==`object`&&n!==`function`||u.has(e)||u.has(t)?!1:ye(e,t,ve):!1}function he(e,t,n){let r=ge.has(e),i=_e.has(t);if(r&&i)return!0;if(r||i)return!1;ge.add(e),_e.add(t);let a=n();return ge.delete(e),_e.delete(t),a}const ge=new WeakSet,_e=new WeakSet;function ve(e,t){if(v(e)!==v(t))return!1;if(e instanceof Date)return t instanceof Date?e.toISOString()===t.toISOString():!1;if(e instanceof RegExp)return t instanceof RegExp?e.toString()===t.toString():!1;let n=De(e),r=De(t);if(n!==r)return!1;let i=n&&r;return typeof e==`function`&&!i?!1:he(e,t,()=>i?e[x](t):Array.isArray(e)?!Array.isArray(t)||e.length!==t.length?!1:xe(e,t):e instanceof Map?!(t instanceof Map)||e.size!==t.size?!1:we(e,t):e instanceof Set?!(t instanceof Set)||e.size!==t.size?!1:Ee(e,t):Se(e,t))}function ye(e,t,n){let r=be.get(e);if(!r)r=new WeakMap,be.set(e,r);else if(r.has(t))return r.get(t);let i=n(e,t);r.set(t,i);let a=be.get(t);return a||(a=new WeakMap,be.set(t,a)),a.set(e,i),i}const be=new WeakMap;function xe(e,t){for(let n=0;n<e.length;n++)if(!C(e[n],t[n]))return!1;return!0}function Se(e,t){let n=l(e),r=l(t);if(n.size!==r.size)return!1;for(let i of n)if(!r.has(i)||!C(e[i],t[i]))return!1;return!0}function Ce(e,t){return function(n,r){for(let[i,a]of n){let n=!1;for(let[o,s]of r)if(e(i,o)&&t(a,s)){n=!0;break}if(!n)return!1}return!0}}const we=Ce(C,C);function Te(e){return function(t,n){for(let r of t){let t=!1;for(let i of n)if(e(r,i)){t=!0;break}if(!t)return!1}return!0}}const Ee=Te(C),De=e=>g(e,x),Oe=()=>S,ke=Symbol.for(`~effect/Inspectable/redactable`),Ae=e=>g(e,ke);function je(e){return Ae(e)?Me(e):e}function Me(e){return e[ke](globalThis[Ne]?.services??Pe)}const Ne=`~effect/Fiber/currentFiber`,Pe={"~effect/ServiceMap":{},mapUnsafe:new Map,pipe(){return e(this,arguments)}};function w(e,t){let n=t?.space??0,r=new WeakSet,i=n?typeof n==`number`?` `.repeat(n):n:``,a=e=>i.repeat(e),o=(e,t)=>{let n=e?.constructor;return n&&n!==Object.prototype.constructor&&n.name?`${n.name}(${t})`:t},s=e=>{try{return Reflect.ownKeys(e)}catch{return[`[ownKeys threw]`]}};function c(e,n=0){if(Array.isArray(e)){if(r.has(e))return Fe;if(r.add(e),!i||e.length<=1)return`[${e.map(e=>c(e,n)).join(`,`)}]`;let t=e.map(e=>c(e,n+1)).join(`,
`+a(n+1));return`[\n${a(n+1)}${t}\n${a(n)}]`}if(e instanceof Date)return Re(e);if(!t?.ignoreToString&&g(e,`toString`)&&typeof e.toString==`function`&&e.toString!==Object.prototype.toString&&e.toString!==Array.prototype.toString){let t=ze(e);return e instanceof Error&&e.cause?`${t} (cause: ${c(e.cause,n)})`:t}if(typeof e==`string`)return JSON.stringify(e);if(typeof e==`number`||e==null||typeof e==`boolean`||typeof e==`symbol`)return String(e);if(typeof e==`bigint`)return String(e)+`n`;if(m(e)){if(r.has(e))return Fe;if(r.add(e),ke in e)return w(Me(e));if(Symbol.iterator in e)return`${e.constructor.name}(${c(Array.from(e),n)})`;let t=s(e);return!i||t.length<=1?o(e,`{${t.map(t=>`${Ie(t)}:${c(e[t],n)}`).join(`,`)}}`):o(e,`{\n${t.map(t=>`${a(n+1)}${Ie(t)}: ${c(e[t],n+1)}`).join(`,
`)}\n${a(n)}}`)}return String(e)}return c(e,0)}const Fe=`[Circular]`;function Ie(e){return typeof e==`string`?JSON.stringify(e):String(e)}function Le(e){return e.map(e=>`[${Ie(e)}]`).join(``)}function Re(e){try{return e.toISOString()}catch{return`Invalid Date`}}function ze(e){try{let t=e.toString();return typeof t==`string`?t:String(t)}catch{return`[toString threw]`}}function Be(e,t){let n=[],r=JSON.stringify(e,(e,t)=>typeof t==`object`&&t?n.includes(t)?void 0:n.push(t)&&je(t):t,t?.space);return n=void 0,r}const Ve=Symbol.for(`nodejs.util.inspect.custom`),He=e=>{try{if(g(e,`toJSON`)&&p(e.toJSON)&&e.toJSON.length===0)return e.toJSON();if(Array.isArray(e))return e.map(He)}catch{return`[toJSON threw]`}return je(e)};Symbol.iterator;var Ue=class e{called=!1;self;constructor(e){this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}[Symbol.iterator](){return new e(this.self)}};const We=`~effect/Effect/internal`,Ge={[We]:e=>e()},Ke={[We]:e=>{try{return e()}finally{}}},qe=Ge[We](()=>Error().stack)?.includes(We)===!0?Ge[We]:Ke[We];(function*(){}).constructor;const Je=`~effect/Effect`,Ye=`~effect/Exit`,Xe={_A:r,_E:r,_R:r},Ze=`${Je}/identifier`,T=`${Je}/args`,E=`${Je}/evaluate`,D=`${Je}/successCont`,O=`${Je}/failureCont`,k=`${Je}/ensureCont`,Qe=Symbol.for(`effect/Effect/Yield`),$e={pipe(){return e(this,arguments)},toJSON(){return{...this}},toString(){return w(this,{ignoreToString:!0})},[Ve](){return this.toJSON()}},et={[_](){return ae(this,Object.keys(this))},[x](e){let t=Object.keys(this),n=Object.keys(e);if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==n[r]&&!S(this[t[r]],e[t[r]]))return!1;return!0}},tt={[Symbol.iterator](){return new Ue(this)}},nt={[Je]:Xe,...$e,[Symbol.iterator](){return new Ue(this)},asEffect(){return this},toJSON(){return{_id:`Effect`,op:this[Ze],...T in this?{args:this[T]}:void 0}}},rt=e=>g(e,Ye),it=`~effect/Cause`,at=`~effect/Cause/Reason`,ot=e=>g(e,it);var st=class{[it];reasons;constructor(e){this[it]=it,this.reasons=e}pipe(){return e(this,arguments)}toJSON(){return{_id:`Cause`,failures:this.reasons.map(e=>e.toJSON())}}toString(){return`Cause(${w(this.reasons)})`}[Ve](){return this.toJSON()}[x](e){return ot(e)&&this.reasons.length===e.reasons.length&&this.reasons.every((t,n)=>S(t,e.reasons[n]))}[_](){return ce(this.reasons)}};const ct=new WeakMap;var lt=class{[at];annotations;_tag;constructor(e,t,n){if(this[at]=at,this._tag=e,t!==ut&&typeof n==`object`&&n&&t.size>0){let e=ct.get(n);e&&(t=new Map([...e,...t])),ct.set(n,t)}this.annotations=t}annotate(e,t){if(e.mapUnsafe.size===0)return this;let n=new Map(this.annotations);e.mapUnsafe.forEach((e,r)=>{t?.overwrite!==!0&&n.has(r)||n.set(r,e)});let r=Object.assign(Object.create(Object.getPrototypeOf(this)),this);return r.annotations=n,r}pipe(){return e(this,arguments)}toString(){return w(this)}[Ve](){return this.toString()}};const ut=new Map;var dt=class extends lt{error;constructor(e,t=ut){super(`Fail`,t,e),this.error=e}toString(){return`Fail(${w(this.error)})`}toJSON(){return{_tag:`Fail`,error:this.error}}[x](e){return _t(e)&&S(this.error,e.error)&&S(this.annotations,e.annotations)}[_](){return y(b(this._tag))(y(v(this.error))(v(this.annotations)))}};const ft=e=>new st(e),pt=e=>new st([new dt(e)]);var mt=class extends lt{defect;constructor(e,t=ut){super(`Die`,t,e),this.defect=e}toString(){return`Die(${w(this.defect)})`}toJSON(){return{_tag:`Die`,defect:this.defect}}[x](e){return vt(e)&&S(this.defect,e.defect)&&S(this.annotations,e.annotations)}[_](){return y(b(this._tag))(y(v(this.defect))(v(this.annotations)))}};const ht=e=>new st([new mt(e)]),gt=n(e=>ot(e[0]),(e,t,n)=>t.mapUnsafe.size===0?e:new st(e.reasons.map(e=>e.annotate(t,n)))),_t=e=>e._tag===`Fail`,vt=e=>e._tag===`Die`,yt=e=>e._tag===`Interrupt`;function bt(e){return Tt(`Effect.evaluate: Not implemented`)}const xt=e=>({...nt,[Ze]:e.op,[E]:e[E]??bt,[D]:e[D],[O]:e[O],[k]:e[k]}),A=e=>{let t=xt(e);return function(){let n=Object.create(t);return n[T]=e.single===!1?arguments:arguments[0],n}},St=e=>{let t={...xt(e),[Ye]:Ye,_tag:e.op,get[e.prop](){return this[T]},toString(){return`${e.op}(${w(this[T])})`},toJSON(){return{_id:`Exit`,_tag:e.op,[e.prop]:this[T]}},[x](e){return rt(e)&&e._tag===this._tag&&S(this[T],e[T])},[_](){return y(b(e.op),v(this[T]))}};return function(e){let n=Object.create(t);return n[T]=e,n}},j=St({op:`Success`,prop:`value`,[E](e){let t=e.getCont(D);return t?t[D](this[T],e,this):e.yieldWith(this)}}),Ct={key:`effect/Cause/StackTrace`},M=St({op:`Failure`,prop:`cause`,[E](e){let t=this[T],n=!1;e.currentStackFrame&&(t=gt(t,{mapUnsafe:new Map([[Ct.key,e.currentStackFrame]])}),n=!0);let r=e.getCont(O);for(;e.interruptible&&e._interruptedCause&&r;)r=e.getCont(O);return r?r[O](t,e,n?void 0:this):e.yieldWith(n?this:M(t))}}),wt=e=>M(pt(e)),Tt=e=>M(ht(e)),Et=A({op:`WithFiber`,[E](e){return this[T](e)}}),Dt=function(){class e extends globalThis.Error{asEffect(){return wt(this)}}return Object.assign(e.prototype,tt),e}(),Ot=function(){let e=Symbol.for(`effect/Data/Error/plainArgs`);return class extends Dt{constructor(t){super(t?.message,t?.cause?{cause:t.cause}:void 0),t&&(Object.assign(this,t),Object.defineProperty(this,e,{value:t,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}(),kt=e=>{class t extends Ot{_tag=e}return t.prototype.name=e,t},At=`~effect/Cause/NoSuchElementError`;var jt=class extends kt(`NoSuchElementError`){[At]=At;constructor(e){super({message:e})}};const Mt=`~effect/data/Option`,Nt={[Mt]:{_A:e=>e},...$e,...tt},Pt=Object.assign(Object.create(Nt),{_tag:`Some`,_op:`Some`,[x](e){return Lt(e)&&zt(e)&&S(this.value,e.value)},[_](){return y(v(this._tag))(v(this.value))},toString(){return`some(${w(this.value)})`},toJSON(){return{_id:`Option`,_tag:this._tag,value:He(this.value)}},asEffect(){return j(this.value)}}),Ft=v(`None`),It=Object.assign(Object.create(Nt),{_tag:`None`,_op:`None`,[x](e){return Lt(e)&&Rt(e)},[_](){return Ft},toString(){return`none()`},toJSON(){return{_id:`Option`,_tag:this._tag}},asEffect(){return wt(new jt)}}),Lt=e=>g(e,Mt),Rt=e=>e._tag===`None`,zt=e=>e._tag===`Some`,Bt=Object.create(It),Vt=e=>{let t=Object.create(Pt);return t.value=e,t},Ht=`~effect/data/Result`,Ut={[Ht]:{_A:e=>e,_E:e=>e},...$e,...tt},Wt=Object.assign(Object.create(Ut),{_tag:`Success`,_op:`Success`,[x](e){return Kt(e)&&Jt(e)&&S(this.success,e.success)},[_](){return y(v(this._tag))(v(this.success))},toString(){return`success(${w(this.success)})`},toJSON(){return{_id:`Result`,_tag:this._tag,value:He(this.success)}},asEffect(){return j(this.success)}}),Gt=Object.assign(Object.create(Ut),{_tag:`Failure`,_op:`Failure`,[x](e){return Kt(e)&&qt(e)&&S(this.failure,e.failure)},[_](){return y(v(this._tag))(v(this.failure))},toString(){return`failure(${w(this.failure)})`},toJSON(){return{_id:`Result`,_tag:this._tag,failure:He(this.failure)}},asEffect(){return wt(this.failure)}}),Kt=e=>g(e,Ht),qt=e=>e._tag===`Failure`,Jt=e=>e._tag===`Success`,Yt=e=>{let t=Object.create(Gt);return t.failure=e,t},Xt=e=>{let t=Object.create(Wt);return t.success=e,t};function Zt(e){return(t,n)=>t===n?0:e(t,n)}const Qt=Zt((e,t)=>globalThis.Number.isNaN(e)&&globalThis.Number.isNaN(t)?0:globalThis.Number.isNaN(e)?-1:globalThis.Number.isNaN(t)?1:e<t?-1:1),$t=e=>n(2,(t,n)=>e(t,n)!==1),en=e=>n(2,(t,n)=>e(t,n)!==-1),tn=()=>Bt,N=Vt,nn=Rt,rn=zt,an=n(2,(e,t)=>nn(e)?tn():N(t(e.value))),on=Xt,sn=Yt,P=qt,cn=(e,t,...n)=>{let r=e(t,...n);return r===!0?on(t):r===!1?sn(t):r},ln=e=>e.length>0,un=globalThis.Array,dn=e=>un.isArray(e)?e:un.from(e),fn=n(2,(e,t)=>[...e,t]),pn=n(2,(e,t)=>dn(e).concat(dn(t)));un.isArray;const mn=ln,hn=ln;function gn(e,t){return e<0||e>=t.length}const _n=n(2,(e,t)=>{let n=Math.floor(t);if(gn(n,e))throw Error(`Index out of bounds: ${n}`);return e[n]})(0),vn=e=>e.slice(1),yn=n(3,(e,t,n)=>{let r=dn(e),i=dn(t);return hn(r)?hn(i)?xn(n)(pn(r,i)):r:i}),bn=n(2,(e,t)=>yn(e,t,Oe())),xn=n(2,(e,t)=>{let n=dn(e);if(hn(n)){let e=[_n(n)],r=vn(n);for(let n of r)e.every(e=>!t(n,e))&&e.push(n);return e}return[]}),Sn=`~effect/time/Duration`,Cn=e=>{switch(e.value._tag){case`Infinity`:case`NegativeInfinity`:throw Error(`Cannot convert infinite duration to nanos`);case`Nanos`:return e.value.nanos;case`Millis`:return BigInt(Math.round(e.value.millis*1e6))}},wn=n(3,(e,t,n)=>e.value._tag===`Infinity`||e.value._tag===`NegativeInfinity`||t.value._tag===`Infinity`||t.value._tag===`NegativeInfinity`?n.onInfinity(e,t):e.value._tag===`Millis`?t.value._tag===`Millis`?n.onMillis(e.value.millis,t.value.millis):n.onNanos(Cn(e),t.value.nanos):n.onNanos(e.value.nanos,Cn(t))),Tn=(e,t)=>wn(e,t,{onMillis:(e,t)=>e===t,onNanos:(e,t)=>e===t,onInfinity:(e,t)=>e.value._tag===t.value._tag}),En=function(){let e=Error.stackTraceLimit;Error.stackTraceLimit=2;let t=Error();Error.stackTraceLimit=e;function n(){}let r=n;return Object.setPrototypeOf(r,Dn),Object.defineProperty(r,`stack`,{get(){return t.stack}}),arguments.length>0?(r.key=arguments[0],arguments[1]?.defaultValue&&(r[On]=On,r.defaultValue=arguments[1].defaultValue),r):function(e,t){return r.key=e,t?.make&&(r.make=t.make),r}},Dn={"~effect/ServiceMap/Service":{_Service:e=>e,_Identifier:e=>e},...$e,...tt,toJSON(){return{_id:`Service`,key:this.key,stack:this.stack}},asEffect(){return(this.asEffect=i(Et(e=>j(In(e.services,this)))))()},of(e){return e},serviceMap(e){return Pn(this,e)},use(e){return Et(t=>e(In(t.services,this)))},useSync(e){return Et(t=>j(e(In(t.services,this))))}},On=`~effect/ServiceMap/Reference`,kn=`~effect/ServiceMap`,F=e=>{let t=Object.create(An);return t.mapUnsafe=e,t},An={...$e,[kn]:{_Services:e=>e},toJSON(){return{_id:`ServiceMap`,services:Array.from(this.mapUnsafe).map(([e,t])=>({key:e,value:t}))}},[x](e){if(!jn(e)||this.mapUnsafe.size!==e.mapUnsafe.size)return!1;for(let t of this.mapUnsafe.keys())if(!e.mapUnsafe.has(t)||!S(this.mapUnsafe.get(t),e.mapUnsafe.get(t)))return!1;return!0},[_](){return ie(this.mapUnsafe.size)}},jn=e=>g(e,kn),Mn=()=>Nn,Nn=F(new Map),Pn=(e,t)=>F(new Map([[e.key,t]])),Fn=n(3,(e,t,n)=>{let r=new Map(e.mapUnsafe);return r.set(t.key,n),F(r)}),In=n(2,(e,t)=>{if(!e.mapUnsafe.has(t.key)){if(On in t)return zn(t);throw Bn(t)}return e.mapUnsafe.get(t.key)}),Ln=(e,t)=>e.mapUnsafe.has(t.key)?e.mapUnsafe.get(t.key):zn(t),Rn=`~effect/ServiceMap/defaultValue`,zn=e=>Rn in e?e[Rn]:e[Rn]=e.defaultValue(),Bn=e=>{let t=Error(`Service not found${e.key?`: ${String(e.key)}`:``}`);if(e.stack){let n=e.stack.split(`
`);if(n.length>2){let e=n[2].match(/at (.*)/);e&&(t.message+=` (defined at ${e[1]})`)}}if(t.stack){let e=t.stack.split(`
`);e.splice(1,3),t.stack=e.join(`
`)}return t},Vn=n(2,(e,t)=>{if(e.mapUnsafe.size===0)return t;if(t.mapUnsafe.size===0)return e;let n=new Map(e.mapUnsafe);return t.mapUnsafe.forEach((e,t)=>n.set(t,e)),F(n)}),Hn=(...e)=>{let t=new Map;for(let n=0;n<e.length;n++)e[n].mapUnsafe.forEach((e,n)=>{t.set(n,e)});return F(t)},Un=En,Wn=Un(`effect/Scheduler`,{defaultValue:()=>new qn}),Gn=`setImmediate`in globalThis?e=>{let t=globalThis.setImmediate(e);return()=>globalThis.clearImmediate(t)}:e=>{let t=setTimeout(e,0);return()=>clearTimeout(t)};var Kn=class{buckets=[];scheduleTask(e,t){let n=this.buckets,r=n.length,i,a=0;for(;a<r&&!(n[a][0]>t);a++)i=n[a];i&&i[0]===t?i[1].push(e):a===r?n.push([t,[e]]):n.splice(a,0,[t,[e]])}drain(){let e=this.buckets;return this.buckets=[],e}},qn=class{tasks=new Kn;running=void 0;executionMode;setImmediate;constructor(e=`async`,t=Gn){this.executionMode=e,this.setImmediate=t}scheduleTask(e,t){this.tasks.scheduleTask(e,t),this.running===void 0&&(this.running=this.setImmediate(this.afterScheduled))}afterScheduled=()=>{this.running=void 0,this.runTasks()};runTasks(){let e=this.tasks.drain();for(let t=0;t<e.length;t++){let n=e[t][1];for(let e=0;e<n.length;e++)n[e]()}}shouldYield(e){return e.currentOpCount>=e.maxOpsBeforeYield}flush(){for(;this.tasks.buckets.length>0;)this.running!==void 0&&(this.running(),this.running=void 0),this.runTasks()}};const Jn=Un(`effect/Scheduler/MaxOpsBeforeYield`,{defaultValue:()=>2048}),Yn=`effect/Tracer/ParentSpan`;En()(Yn);const Xn=Un(`effect/Tracer/DisablePropagation`,{defaultValue:a}),Zn=Un(`effect/References/CurrentConcurrency`,{defaultValue:()=>`unbounded`}),Qn=Un(`effect/References/CurrentStackFrame`,{defaultValue:o}),$n=Un(`effect/References/CurrentLogLevel`,{defaultValue:()=>`Info`}),er=Un(`effect/References/MinimumLogLevel`,{defaultValue:()=>`Info`});var tr=class extends lt{fiberId;constructor(e,t=ut){super(`Interrupt`,t,`Interrupted`),this.fiberId=e}toString(){return`Interrupt(${this.fiberId})`}toJSON(){return{_tag:`Interrupt`,fiberId:this.fiberId}}[x](e){return yt(e)&&this.fiberId===e.fiberId&&this.annotations===e.annotations}[_](){return y(b(`${this._tag}:${this.fiberId}`))(te(this.annotations))}};const nr=e=>new st([new tr(e)]),rr=e=>{for(let t=0;t<e.reasons.length;t++){let n=e.reasons[t];if(n._tag===`Fail`)return on(n.error)}return sn(e)},ir=e=>e.reasons.some(yt),ar=n(2,(e,t)=>{if(e.reasons.length===0)return t;if(t.reasons.length===0)return e;let n=new st(bn(e.reasons,t.reasons));return S(e,n)?e:n}),or=e=>{let t={Fail:[],Die:[],Interrupt:[]};for(let n=0;n<e.reasons.length;n++)t[e.reasons[n]._tag].push(e.reasons[n]);return t},sr=e=>{let t=or(e);return t.Fail.length>0?t.Fail[0].error:t.Die.length>0?t.Die[0].defect:t.Interrupt.length>0?new globalThis.Error(`All fibers interrupted without error`):new globalThis.Error(`Empty cause`)},cr=(e,t)=>{let n=typeof e,r;if(e&&n===`object`){if(r=new globalThis.Error(lr(e),{cause:e.cause?cr(e.cause):void 0}),typeof e.name==`string`&&(r.name=e.name),typeof e.stack==`string`)r.stack=dr(e.stack,r,t);else{let e=`${r.name}: ${r.message}`;r.stack=t?fr(e,t):e}for(let t of Object.keys(e))t in r||(r[t]=e[t])}else r=new globalThis.Error(e?n===`string`?e:Be(e):`Unknown error: ${e}`);return r},lr=e=>{if(typeof e.message==`string`)return e.message;if(typeof e.toString==`function`&&e.toString!==Object.prototype.toString&&e.toString!==Array.prototype.toString)try{return e.toString()}catch{}return Be(e)},ur=/\((.*)\)/g,dr=(e,t,n)=>{let r=`${t.name}: ${t.message}`,i=(e.startsWith(r)?e.slice(r.length):e).split(`
`),a=[r];for(let e=1;e<i.length&&!/(?:Generator\.next|~effect\/Effect)/.test(i[e]);e++)a.push(i[e]);return n?fr(a.join(`
`),n):a.join(`
`)},fr=(e,t)=>{let n=t?.get(Ct.key);return n&&(e=`${e}\n${pr(n)}`),e},pr=e=>{let t=[],n=e,r=0;for(;n&&r<10;){let e=n.stack();if(e){let r=e.matchAll(ur),i=!1;for(let[,e]of r)i=!0,t.push(`    at ${n.name} (${e})`);i||t.push(`    at ${n.name} (${e.replace(/^at /,``)})`)}else t.push(`    at ${n.name}`);n=n.parent,r++}return t.join(`
`)},mr=(e,t)=>{let n=e.stack.split(`
`),r=`${t}[cause]: ${n[0]}`;for(let e=1,i=n.length;e<i;e++)r+=`\n${t}${n[e]}`;return e.cause&&(r+=` {\n${mr(e.cause,`${t}  `)}\n${t}}`),r},hr=`~effect/Fiber/dev`,gr={_A:r,_E:r},_r={id:0},vr=()=>globalThis[Ne],yr=(()=>{let e=0,t;return{increment(){e++,t??=globalThis.setInterval(s,2147483647)},decrement(){e--,e===0&&t!==void 0&&(globalThis.clearInterval(t),t=void 0)}}})();var br=class{constructor(e,t=!0){this[hr]=gr,this.setServices(e),this.id=++_r.id,this.currentOpCount=0,this.currentLoopCount=0,this.interruptible=t,this._stack=[],this._observers=[],this._exit=void 0,this._children=void 0,this._interruptedCause=void 0,this._yielded=void 0}[hr];id;interruptible;currentOpCount;currentLoopCount;_stack;_observers;_exit;_currentExit;_children;_interruptedCause;_yielded;services;currentScheduler;currentTracerContext;currentSpan;currentLogLevel;minimumLogLevel;currentStackFrame;runtimeMetrics;maxOpsBeforeYield;getRef(e){return Ln(this.services,e)}addObserver(e){return this._exit?(e(this._exit),s):(this._observers.push(e),()=>{let t=this._observers.indexOf(e);t>=0&&this._observers.splice(t,1)})}interruptUnsafe(e,t){if(this._exit)return;let n=nr(e);this.currentStackFrame&&(n=gt(n,Pn(Ct,this.currentStackFrame))),t&&(n=gt(n,t)),this._interruptedCause=this._interruptedCause?ar(this._interruptedCause,n):n,this.interruptible&&this.evaluate(Tr(this._interruptedCause))}pollUnsafe(){return this._exit}evaluate(e){if(this.runtimeMetrics?.recordFiberStart(this.services),this._exit)return;if(this._yielded!==void 0){let e=this._yielded;this._yielded=void 0,e()}let t=this.runLoop(e);if(t===Qe)return;let n=xr.interruptChildren&&xr.interruptChildren(this);if(n!==void 0)return this.evaluate(R(n,()=>t));this._exit=t,this.runtimeMetrics?.recordFiberEnd(this.services,this._exit);for(let e=0;e<this._observers.length;e++)this._observers[e](t);this._observers.length=0}runLoop(e){let t=globalThis[Ne];globalThis[Ne]=this;let n=!1,r=e;this.currentOpCount=0;let i=++this.currentLoopCount;try{for(;;){if(this.currentOpCount++,!n&&this.currentScheduler.shouldYield(this)){n=!0;let e=r;r=R(Or,()=>e)}if(r=this.currentTracerContext?this.currentTracerContext(r,this):r[E](this),i!==this.currentLoopCount)return Qe;if(r===Qe){let e=this._yielded;return Ye in e?(this._yielded=void 0,e):Qe}}}catch(e){return g(r,E)?this.runLoop(Tt(e)):Tt(`Fiber.runLoop: Not a valid effect: ${String(r)}`)}finally{globalThis[Ne]=t}}getCont(e){for(;;){let t=this._stack.pop();if(!t)return;let n=t[k]&&t[k](this);if(n)return n[e]=n,n;if(t[e])return t}}yieldWith(e){return this._yielded=e,Qe}children(){return this._children??=new Set}pipe(){return e(this,arguments)}setServices(e){this.services=e,this.currentScheduler=this.getRef(Wn),this.currentSpan=e.mapUnsafe.get(Yn),this.currentLogLevel=this.getRef($n),this.minimumLogLevel=this.getRef(er),this.currentStackFrame=e.mapUnsafe.get(Qn.key),this.maxOpsBeforeYield=this.getRef(Jn),this.runtimeMetrics=e.mapUnsafe.get(`effect/observability/Metric/FiberRuntimeMetricsKey`);let t=e.mapUnsafe.get(`effect/Tracer`);this.currentTracerContext=t?t.context:void 0}get currentSpanLocal(){return this.currentSpan?._tag===`Span`?this.currentSpan:void 0}};const xr={interruptChildren:void 0},Sr=e=>{if(!e.currentStackFrame)return;let t=new Map;return t.set(Ct.key,e.currentStackFrame),F(t)},Cr=e=>Ir(t=>{let n=e[Symbol.iterator](),r=[],i;function a(){let e=n.next();for(;!e.done;){if(e.value._exit){r.push(e.value._exit),e=n.next();continue}i=e.value.addObserver(e=>{r.push(e),a()});return}t(I(r))}return a(),Dr(()=>i?.())}),wr=e=>Et(t=>{let n=Sr(t);for(let r of e)r.interruptUnsafe(t.id,n);return Hr(Cr(e))}),I=j,Tr=M,Er=wt,Dr=A({op:`Sync`,[E](e){let t=this[T](),n=e.getCont(D);return n?n[D](t,e):e.yieldWith(j(t))}}),L=A({op:`Suspend`,[E](e){return this[T]()}}),Or=A({op:`Yield`,[E](e){let t=!1;return e.currentScheduler.scheduleTask(()=>{t||e.evaluate(Yr)},this[T]??0),e.yieldWith(()=>{t=!0})}})(0),kr=e=>I(N(e)),Ar=I(tn()),jr=e=>Tt(e),Mr=e=>L(()=>Er(qe(e))),Nr=I(void 0),Pr=A({op:`Async`,single:!1,[E](e){let t=qe(()=>this[T][0].bind(e.currentScheduler)),n=!1,r=!1,i=this[T][1]?new AbortController:void 0,a=t(t=>{n||(n=!0,r?e.evaluate(t):r=t)},i?.signal);return r===!1?(r=!0,yr.increment(),e._yielded=()=>{n=!0,yr.decrement()},i===void 0&&a===void 0||e._stack.push(Fr(()=>(n=!0,i?.abort(),a??Yr))),Qe):r}}),Fr=A({op:`AsyncFinalizer`,[k](e){e.interruptible&&(e.interruptible=!1,e._stack.push(Si))},[O](e,t){return ir(e)?R(this[T](),()=>Tr(e)):Tr(e)}}),Ir=e=>Pr(e,e.length>=2),Lr=(e,...t)=>t.length===0?function(){return L(()=>Br(e.apply(this,arguments)))}:function(){let n=L(()=>Br(e.apply(this,arguments)));for(let e=0;e<t.length;e++)n=t[e](n,...arguments);return n},Rr=(e,...t)=>t.length===0?function(){return zr(()=>e.apply(this,arguments))}:function(){let n=zr(()=>e.apply(this,arguments));for(let e of t)n=e(n);return n},zr=e=>{try{let t=e(),n;for(;;){let r=t.next(n);if(r.done)return I(r.value);let i=r.value.asEffect(),a=i;if(a&&a._tag===`Success`){n=a.value;continue}else if(a&&a._tag===`Failure`)return i;else{let n=!0;return L(()=>n?(n=!1,R(i,e=>Br(t,e))):L(()=>Br(e())))}}}catch(e){return jr(e)}},Br=A({op:`Iterator`,single:!1,[D](e,t){let n=this[T][0];for(;;){let r=n.next(e);if(r.done)return I(r.value);let i=r.value.asEffect();if(!z(i))return t._stack.push(this),i;if(i._tag===`Failure`)return i;e=i.value}},[E](e){return this[D](this[T][1],e)}}),Vr=n(2,(e,t)=>{let n=I(t);return R(e,e=>n)}),Hr=e=>R(e,e=>Yr),R=n(2,(e,t)=>{let n=Object.create(Ur);return n[T]=e,n[D]=t.length===1?t:e=>t(e),n}),Ur=xt({op:`OnSuccess`,[E](e){return e._stack.push(this),this[T]}}),z=e=>Ye in e,Wr=n(2,(e,t)=>z(e)?e._tag===`Success`?t(e.value):e:R(e,t)),Gr=n(2,(e,t)=>R(e,e=>I(qe(()=>t(e))))),Kr=n(2,(e,t)=>z(e)?Xr(e,t):Gr(e,t)),qr=n(2,(e,t)=>z(e)?Zr(e,t):oi(e,t)),Jr=n(2,(e,t)=>{if(z(e)){if(e._tag===`Success`)return e;let n=rr(e.cause);return P(n)?e:t(n.success)}return ai(e,t)}),Yr=j(void 0),Xr=n(2,(e,t)=>e._tag===`Success`?j(t(e.value)):e),Zr=n(2,(e,t)=>{if(e._tag===`Success`)return e;let n=rr(e.cause);return P(n)?e:wt(t(n.success))}),Qr=e=>{let t=[];for(let n of e)n._tag===`Failure`&&t.push(...n.cause.reasons);return t.length===0?Yr:M(ft(t))},$r=n(2,(e,t)=>Et(n=>{let r=n.services,i=t(r);if(r===i)return e;n.setServices(i);let a=new Map;for(let[e,t]of n.services.mapUnsafe)(!r.mapUnsafe.has(e)||t!==r.mapUnsafe.get(e))&&a.set(e,t);return bi(e,()=>{let e=new Map(n.services.mapUnsafe);for(let[t,n]of a)n===e.get(t)&&(r.mapUnsafe.has(t)?e.set(t,r.mapUnsafe.get(t)):e.delete(t));n.setServices(F(e))})})),ei=e=>Et(t=>e(t.services)),ti=n(2,(e,t)=>z(e)?e:$r(e,Vn(t))),ni=n(2,(e,t)=>{let n=Object.create(ri);return n[T]=e,n[O]=t.length===1?t:e=>t(e),n}),ri=xt({op:`OnFailure`,[E](e){return e._stack.push(this),this[T]}}),ii=n(3,(e,t,n)=>ni(e,e=>{let r=cn(t,e);return P(r)?Tr(r.failure):qe(()=>n(r.success,e))})),ai=n(2,(e,t)=>ii(e,rr,e=>t(e))),oi=n(2,(e,t)=>ai(e,e=>Mr(()=>t(e)))),si=e=>ai(e,t=>R(Or,()=>si(e))),ci=e=>z(e)?j(e):li(e),li=A({op:`Exit`,[E](e){return e._stack.push(this),this[T]},[D](e,t,n){return I(n??j(e))},[O](e,t,n){return I(n??M(e))}}),ui=`~effect/Scope`,di=`~effect/Scope/Closeable`,fi=(e,t)=>L(()=>pi(e,t)??Nr),pi=(e,t)=>{if(e.state._tag===`Closed`)return;let n={_tag:`Closed`,exit:t};if(e.state._tag===`Empty`){e.state=n;return}let{finalizers:r}=e.state;if(e.state=n,r.size!==0)return r.size===1?r.values().next().value(t):mi(e,r,t)},mi=Lr(function*(e,t,n){let r=[],i=[],a=Array.from(t.values()),o=vr();for(let t=a.length-1;t>=0;t--){let s=a[t];e.strategy===`sequential`?r.push(yield*ci(s(n))):i.push(Ei(o,s(n),!0,!0,`inherit`))}return i.length>0&&(r=yield*Cr(i)),yield*Qr(r)}),hi=(e,t)=>{let n=vi(t);if(e.state._tag===`Closed`)return n.state=e.state,n;let r={};return gi(e,r,e=>fi(n,e)),gi(n,r,t=>Dr(()=>_i(e,r))),n},gi=(e,t,n)=>{e.state._tag===`Empty`?e.state={_tag:`Open`,finalizers:new Map([[t,n]])}:e.state._tag===`Open`&&e.state.finalizers.set(t,n)},_i=(e,t)=>{e.state._tag===`Open`&&e.state.finalizers.delete(t)},vi=(e=`sequential`)=>({[di]:di,[ui]:ui,strategy:e,state:yi}),yi={_tag:`Empty`},bi=A({op:`OnExit`,single:!1,[E](e){return e._stack.push(this),this[T][0]},[k](e){e.interruptible&&this[T][2]!==!0&&(e._stack.push(Si),e.interruptible=!1)},[D](e,t,n){n??=j(e);let r=this[T][1](n);return r?R(r,e=>n):n},[O](e,t,n){n??=M(e);let r=this[T][1](n);return r?R(r,e=>n):n}}),xi=n(2,bi),Si=A({op:`SetInterruptible`,[k](e){if(e.interruptible=this[T],e._interruptedCause&&e.interruptible)return()=>Tr(e._interruptedCause)}})(!0),Ci=A({op:`While`,[D](e,t){return this[T].step(e),this[T].while()?(t._stack.push(this),this[T].body()):Yr},[E](e){return this[T].while()?(e._stack.push(this),this[T].body()):Yr}}),wi=n(e=>typeof e[1]==`function`,(e,t,n)=>Et(r=>{let i=n?.concurrency===`inherit`?r.getRef(Zn):n?.concurrency??1,a=i===`unbounded`?1/0:Math.max(1,i);if(a===1)return Ti(e,t,n);let o=dn(e),s=o.length;if(s===0)return n?.discard?Nr:I([]);let c=n?.discard?void 0:Array(s),l=0,u=Sr(r);return Ir(e=>{let n=new Set,i=[],d=!1,f=0,p=0,ee=!1,m=!1;function h(){for(ee=!0;f<a&&l<s;){let g=l,_=o[g];l++,f++;try{let o=Ei(r,t(_,g),!0,!0,`inherit`);n.add(o),o.addObserver(t=>{if(!m){if(n.delete(o),t._tag===`Failure`)if(!d)d=!0,s=l,i.push(...t.cause.reasons),n.forEach(e=>e.interruptUnsafe(r.id,u));else for(let e of t.cause.reasons)e._tag!==`Interrupt`&&i.push(e);else c!==void 0&&(c[g]=t.value);p++,f--,p===s?e(i.length>0?M(ft(i)):I(c)):!ee&&!d&&f<a&&h()}})}catch(e){d=!0,s=l,i.push(new mt(e)),n.forEach(e=>e.interruptUnsafe(r.id,u))}}ee=!1}return h(),L(()=>(m=!0,l=s,wr(n)))})})),Ti=(e,t,n)=>L(()=>{let r=n?.discard?void 0:[],i=e[Symbol.iterator](),a=i.next(),o=0;return Vr(Ci({while:()=>!a.done,body:()=>t(a.value,o++),step:e=>{r&&r.push(e),a=i.next()}}),r)}),Ei=(e,t,n=!1,r=!1,i=!1)=>{let a=i===`inherit`?e.interruptible:!i,o=new br(e.services,a);return n?o.evaluate(t):e.currentScheduler.scheduleTask(()=>o.evaluate(t),0),!r&&!o._exit&&(e.children().add(o),o.addObserver(()=>e._children.delete(o))),o},Di=e=>(t,n)=>{let r=n?.scheduler||!e.mapUnsafe.has(Wn.key)&&new qn,i=new br(r?Fn(e,Wn,r):e,n?.uninterruptible!==!0);if(i.evaluate(t),i._exit)return i;if(n?.signal)if(n.signal.aborted)i.interruptUnsafe();else{let e=()=>i.interruptUnsafe();n.signal.addEventListener(`abort`,e,{once:!0}),i.addObserver(()=>n.signal.removeEventListener(`abort`,e))}return i},Oi=e=>{let t=Di(e);return e=>{if(z(e))return e;let n=new qn(`sync`),r=t(e,{scheduler:n});return n.flush(),r._exit??Tt(r)}},ki=(e=>{let t=Oi(e);return e=>{let n=t(e);if(n._tag===`Failure`)throw sr(n.cause);return n.value}})(Mn()),Ai=e=>{if(e)return In(e.annotations,Xn)?e._tag===`Span`?Ai(e.parent):void 0:e};kt(`TimeoutError`),kt(`IllegalArgumentError`),kt(`ExceededCapacityError`),kt(`UnknownError`);const B={bold:`1`,red:`31`,green:`32`,yellow:`33`,blue:`34`,cyan:`36`,white:`37`,gray:`90`,black:`30`,bgBrightRed:`101`};B.gray,B.blue,B.green,B.yellow,B.red,B.bgBrightRed,B.black;const ji=typeof process==`object`&&process!==null&&typeof process.stdout==`object`&&process.stdout!==null;ji&&process.stdout.isTTY,ji||`Deno`in globalThis;const V=rr,Mi=kt,Ni=hi,Pi=fi,Fi=`~effect/Layer`,Ii=e=>g(e,Fi),Li={[Fi]:{_ROut:r,_E:r,_RIn:r},pipe(){return e(this,arguments)}},Ri=e=>{let t=Object.create(Li);return t.build=e,t},zi=e=>Ri((t,n)=>{let r=Ni(n);return xi(e(t,r),e=>e._tag===`Failure`?Pi(r,e):Nr)});En()(`effect/Layer/CurrentMemoMap`);const Bi=e=>Ri(i(I(e))),Vi=(e,t,n)=>{let r=Ni(n,`parallel`);return wi(e,e=>e.build(t,Ni(r,`sequential`)),{concurrency:e.length}).pipe(Gr(e=>Hn(...e)))},Hi=(e,t,n)=>zi((r,i)=>R(Array.isArray(t)?Vi(t,r,i):t.build(r,i),t=>e.build(r,i).pipe(ti(t),Gr(e=>n(e,t))))),Ui=n(2,(e,t)=>Hi(e,t,r)),Wi=`~effect/ExecutionPlan`,Gi={[Wi]:Wi,get withRequirements(){let e=this;return ei(t=>I(Ki(e.steps.map(e=>({...e,provide:Ii(e.provide)?Ui(e.provide,Bi(t)):e.provide})))))},pipe(){return e(this,arguments)}},Ki=e=>{let t=Object.create(Gi);return t.steps=e,t},qi=`~effect/time/DateTime`,Ji=`~effect/time/DateTime/TimeZone`,Yi={[qi]:qi,pipe(){return e(this,arguments)},[Ve](){return this.toString()},toJSON(){return Zi(this).toJSON()}};({...Yi}),{...Yi};const Xi={[Ji]:Ji,[Ve](){return this.toString()}};({...Xi}),{...Xi};const Zi=e=>new Date(e.epochMillis),Qi=e=>{if(e._tag===`Utc`)return new Date(e.epochMillis);if(e.zone._tag===`Offset`)return new Date(e.epochMillis+e.zone.offset);if(e.adjustedEpochMillis!==void 0)return new Date(e.adjustedEpochMillis);let t=e.zone.format.formatToParts(e.epochMillis).filter(e=>e.type!==`literal`),n=new Date(0);return n.setUTCFullYear(Number(t[2].value),Number(t[0].value)-1,Number(t[1].value)),n.setUTCHours(Number(t[3].value),Number(t[4].value),Number(t[5].value),Number(t[6].value)),e.adjustedEpochMillis=n.getTime(),n},$i=e=>Qi(e).getTime()-ta(e),ea=e=>{let t=Math.abs(e),n=Math.floor(t/(3600*1e3)),r=Math.round(t%(3600*1e3)/(60*1e3));return r===60&&(n+=1,r=0),`${e<0?`-`:`+`}${String(n).padStart(2,`0`)}:${String(r).padStart(2,`0`)}`},ta=e=>e.epochMillis;({...et});const na=I,ra=Ar,ia=kr,H=Er,U=ci,aa=ki,oa=Kr,sa=qr,ca=Wr,la=Jr,ua=Rr;En()(`effect/DateTime/CurrentTimeZone`),Mi(`EncodingError`);function da(e){return e.checks?e.checks[e.checks.length-1].annotations:e.annotations}const fa=c(e=>e.getExpected(fa));function pa(e,t,n){return t===`__proto__`?Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0}):e[t]=n,e}globalThis.RegExp;const ma=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,`\\$&`),ha=`~effect/SchemaIssue/Issue`;function ga(e){return g(e,ha)}var W=class{[ha]=ha;toString(){return Ma(this)}},_a=class extends W{_tag=`Filter`;actual;filter;issue;constructor(e,t,n){super(),this.actual=e,this.filter=t,this.issue=n}},va=class extends W{_tag=`Encoding`;ast;actual;issue;constructor(e,t,n){super(),this.ast=e,this.actual=t,this.issue=n}},G=class extends W{_tag=`Pointer`;path;issue;constructor(e,t){super(),this.path=e,this.issue=t}},ya=class extends W{_tag=`MissingKey`;annotations;constructor(e){super(),this.annotations=e}},ba=class extends W{_tag=`UnexpectedKey`;ast;actual;constructor(e,t){super(),this.ast=e,this.actual=t}},K=class extends W{_tag=`Composite`;ast;actual;issues;constructor(e,t,n){super(),this.ast=e,this.actual=t,this.issues=n}},xa=class extends W{_tag=`InvalidType`;ast;actual;constructor(e,t){super(),this.ast=e,this.actual=t}},Sa=class extends W{_tag=`InvalidValue`;actual;annotations;constructor(e,t){super(),this.actual=e,this.annotations=t}},Ca=class extends W{_tag=`AnyOf`;ast;actual;issues;constructor(e,t,n){super(),this.ast=e,this.actual=t,this.issues=n}},wa=class extends W{_tag=`OneOf`;ast;actual;successes;constructor(e,t,n){super(),this.ast=e,this.actual=t,this.successes=n}};function Ta(e,t){if(ga(t))return t;if(t!==void 0)return typeof t==`boolean`?t?void 0:new Sa(N(e)):typeof t==`string`?new Sa(N(e),{message:t}):new G(t.path,new Sa(N(e),{message:t.message}))}const Ea=e=>{let t=Pa(e);if(t!==void 0)return t;switch(e._tag){case`InvalidType`:return Oa(fa(e.ast),Ia(e.actual));case`InvalidValue`:return`Invalid data ${Ia(e.actual)}`;case`MissingKey`:return`Missing key`;case`UnexpectedKey`:return`Unexpected key with value ${w(e.actual)}`;case`Forbidden`:return`Forbidden operation`;case`OneOf`:return`Expected exactly one member to match the input ${w(e.actual)}`}},Da=e=>Pa(e.issue)??Pa(e);function Oa(e,t){return`Expected ${e}, got ${t}`}function ka(e,t,n,r){switch(e._tag){case`Filter`:{let i=r(e);if(i!==void 0)return[{path:t,message:i}];switch(e.issue._tag){case`InvalidValue`:return[{path:t,message:Oa(Aa(e.filter),w(e.actual))}];default:return ka(e.issue,t,n,r)}}case`Encoding`:return ka(e.issue,t,n,r);case`Pointer`:return ka(e.issue,[...t,...e.path],n,r);case`Composite`:return e.issues.flatMap(e=>ka(e,t,n,r));case`AnyOf`:{let i=Pa(e);return e.issues.length===0?i===void 0?[{path:t,message:Oa(fa(e.ast),w(e.actual))}]:[{path:t,message:i}]:e.issues.flatMap(e=>ka(e,t,n,r))}default:return[{path:t,message:n(e)}]}}function Aa(e){let t=e.annotations?.expected;if(typeof t==`string`)return t;switch(e._tag){case`Filter`:return`<filter>`;case`FilterGroup`:return e.checks.map(e=>Aa(e)).join(` & `)}}function ja(){return e=>ka(e,[],Ea,Da).map(Na).join(`
`)}const Ma=ja();function Na(e){let t=e.message;if(e.path&&e.path.length>0){let n=Le(e.path);t+=`\n  at ${n}`}return t}function Pa(e){switch(e._tag){case`InvalidType`:case`OneOf`:case`Composite`:case`AnyOf`:return Fa(e.ast.annotations);case`InvalidValue`:case`Forbidden`:return Fa(e.annotations);case`MissingKey`:return Fa(e.annotations,`messageMissingKey`);case`UnexpectedKey`:return Fa(e.ast.annotations,`messageUnexpectedKey`);case`Filter`:return Fa(e.filter.annotations);case`Encoding`:return Pa(e.issue)}}function Fa(e,t=`message`){let n=e?.[t];if(typeof n==`string`)return n}function Ia(e){return nn(e)?`no value provided`:w(e.value)}var La=class e extends t{run;constructor(e){super(),this.run=e}map(t){return new e((e,n)=>this.run(e,n).pipe(oa(an(t))))}compose(t){return za(this)?t:za(t)?this:new e((e,n)=>this.run(e,n).pipe(ca(e=>t.run(e,n))))}};const Ra=new La(na);function za(e){return e.run===Ra.run}function Ba(){return Ra}function Va(e){return Ha(an(e))}function Ha(e){return new La(t=>na(e(t)))}function Ua(){return Va(globalThis.String)}function Wa(){return Va(globalThis.Number)}const Ga=`~effect/SchemaTransformation/Transformation`;var Ka=class e{[Ga]=Ga;_tag=`Transformation`;decode;encode;constructor(e,t){this.decode=e,this.encode=t}flip(){return new e(this.encode,this.decode)}compose(t){return new e(this.decode.compose(t.decode),t.encode.compose(this.encode))}};function qa(e){return g(e,Ga)}const Ja=e=>qa(e)?e:new Ka(e.decode,e.encode),Ya=new Ka(Ba(),Ba());function Xa(){return Ya}const Za=new Ka(Wa(),Ua());function Qa(e){return t=>t._tag===e}const $a=Qa(`Declaration`),eo=Qa(`Never`),to=Qa(`Literal`),no=Qa(`Arrays`),ro=Qa(`Objects`),io=Qa(`Union`);var q=class{to;transformation;constructor(e,t){this.to=e,this.transformation=t}};const ao={};var oo=class{isOptional;isMutable;defaultValue;annotations;constructor(e,t,n=void 0,r=void 0){this.isOptional=e,this.isMutable=t,this.defaultValue=n,this.annotations=r}};const so=`~effect/Schema`;var J=class{[so]=so;annotations;checks;encoding;context;constructor(e=void 0,t=void 0,n=void 0,r=void 0){this.annotations=e,this.checks=t,this.encoding=n,this.context=r}toString(){return`<${this._tag}>`}},co=class e extends J{_tag=`Declaration`;typeParameters;run;constructor(e,t,n,r,i,a){super(n,r,i,a),this.typeParameters=e,this.run=t}getParser(){let e=this.run(this.typeParameters);return(t,n)=>nn(t)?ra:oa(e(t.value,this,n),N)}recur(t){let n=Zo(this.typeParameters,t);return n===this.typeParameters?this:new e(n,this.run,this.annotations,this.checks,void 0,this.context)}getExpected(){let e=this.annotations?.identifier??this.annotations?.expected;return typeof e==`string`?e:`<Declaration>`}};const lo=new class extends J{_tag=`Null`;getParser(){return ds(this,null)}getExpected(){return`null`}};var uo=class extends J{_tag=`Literal`;literal;constructor(e,t,n,r,i){if(super(t,n,r,i),typeof e==`number`&&!globalThis.Number.isFinite(e))throw Error(`A numeric literal must be finite, got ${w(e)}`);this.literal=e}getParser(){return ds(this,this.literal)}toCodecJson(){return typeof this.literal==`bigint`?fo(this):this}toCodecStringTree(){return typeof this.literal==`string`?this:fo(this)}getExpected(){return typeof this.literal==`string`?JSON.stringify(this.literal):globalThis.String(this.literal)}};function fo(e){let t=globalThis.String(e.literal);return Y(e,[new q(new uo(t),new Ka(Va(()=>e.literal),Va(()=>t)))])}const po=new class extends J{_tag=`String`;getParser(){return fs(this,d)}getExpected(){return`string`}};var mo=class extends J{_tag=`Number`;getParser(){return fs(this,f)}toCodecJson(){return this.checks&&(ho(this.checks,`isFinite`)||ho(this.checks,`isInt`))?this:Y(this,[Io])}toCodecStringTree(){return this.checks&&(ho(this.checks,`isFinite`)||ho(this.checks,`isInt`))?Y(this,[ys]):Y(this,[bs])}getExpected(){return`number`}};function ho(e,t){return e.some(e=>{switch(e._tag){case`Filter`:return e.annotations?.meta?._tag===t;case`FilterGroup`:return ho(e.checks,t)}})}const go=new mo;var _o=class e extends J{_tag=`Arrays`;isMutable;elements;rest;constructor(e,t,n,r,i,a,o){super(r,i,a,o),this.isMutable=e,this.elements=t,this.rest=n;let s=t.findIndex(X);if(s!==-1&&(t.slice(s+1).some(e=>!X(e))||n.length>1))throw Error(`A required element cannot follow an optional element. ts(1257)`);if(n.length>1&&n.slice(1).some(X))throw Error(`An optional element cannot follow a rest element. ts(1266)`)}getParser(e){let t=this,n=t.elements.map(t=>({ast:t,parser:e(t)})),r=t.rest.map(t=>({ast:t,parser:e(t)})),i=n.length;return ua(function*(e,a){if(e._tag===`None`)return e;let o=e.value;if(!Array.isArray(o))return yield*H(new xa(t,e));let s=[],c,l=a.errors===`all`,u=0;for(;u<i;u++){let r=n[u],i=u<o.length?N(o[u]):tn(),d=r.parser(i,a),f=z(d)?d:yield*U(d);if(f._tag===`Failure`){let n=V(f.cause);if(P(n))return yield*f;let r=new G([u],n.success);if(l)c?c.push(r):c=[r];else return yield*H(new K(t,e,[r]))}else if(f.value._tag===`Some`)s[u]=f.value.value;else if(!X(r.ast)){let n=new G([u],new ya(r.ast.context?.annotations));if(l)c?c.push(n):c=[n];else return yield*H(new K(t,e,[n]))}}let d=o.length;if(t.rest.length>0){let[n,...i]=r,f=n.ast.context?.annotations;for(;u<d-i.length;u++){let r=n.parser(N(o[u]),a),i=z(r)?r:yield*U(r);if(i._tag===`Failure`){let n=V(i.cause);if(P(n))return yield*i;let r=new G([u],n.success);if(l)c?c.push(r):c=[r];else return yield*H(new K(t,e,[r]))}else if(i.value._tag===`Some`)s[u]=i.value.value;else{let n=new G([u],new ya(f));if(l)c?c.push(n):c=[n];else return yield*H(new K(t,e,[n]))}}for(let n=0;n<i.length;n++)if(d<u+1)continue;else{let r=i[n],d=r.ast.context?.annotations,f=r.parser(N(o[u]),a),p=z(f)?f:yield*U(f);if(p._tag===`Failure`){let n=V(p.cause);if(P(n))return yield*p;let r=new G([u],n.success);if(l)c?c.push(r):c=[r];else return yield*H(new K(t,e,[r]))}else if(p.value._tag===`Some`)s[u]=p.value.value;else{let n=new G([u],new ya(d));if(l)c?c.push(n):c=[n];else return yield*H(new K(t,e,[n]))}}}else for(let n=i;n<=d-1;n++){let r=new G([n],new ba(t,o[n]));if(l)c?c.push(r):c=[r];else return yield*H(new K(t,e,[r]))}return c?yield*H(new K(t,e,c)):N(s)})}recur(t){let n=Zo(this.elements,t),r=Zo(this.rest,t);return n===this.elements&&r===this.rest?this:new e(this.isMutable,n,r,this.annotations,this.checks,void 0,this.context)}getExpected(){return`array`}};const vo=`[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?`,yo=new globalThis.RegExp(`(?:${vo}|Infinity|-Infinity|NaN)`);function bo(e,t){let n=rs(t);switch(n._tag){case`String`:return Object.keys(e);case`TemplateLiteral`:{let t=cs(n);return Object.keys(e).filter(e=>t.test(e))}case`Symbol`:return Object.getOwnPropertySymbols(e);case`Number`:return Object.keys(e).filter(e=>yo.test(e));case`Union`:return[...new Set(n.types.flatMap(t=>bo(e,t)))];default:return[]}}var xo=class{name;type;constructor(e,t){this.name=e,this.type=t}},So=class{parameter;type;merge;constructor(e,t,n){if(this.parameter=e,this.type=t,this.merge=n,X(t)&&!os(t))throw Error("Cannot use `Schema.optionalKey` with index signatures, use `Schema.optional` instead.")}},Co=class e extends J{_tag=`Objects`;propertySignatures;indexSignatures;constructor(e,t,n,r,i,a){super(n,r,i,a),this.propertySignatures=e,this.indexSignatures=t;let o=e.map(e=>e.name).filter((e,t,n)=>n.indexOf(e)!==t);if(o.length>0)throw Error(`Duplicate identifiers: ${JSON.stringify(o)}. ts(2300)`)}getParser(e){let t=this,n=[],r=new Set,i=[],a=t.propertySignatures.length;for(let a of t.propertySignatures)n.push(a.name),r.add(a.name),i.push({ps:a,parser:e(a.type),name:a.name,type:a.type});let o=t.indexSignatures.length;return t.propertySignatures.length===0&&t.indexSignatures.length===0?fs(t,ee):ua(function*(s,c){if(s._tag===`None`)return s;let l=s.value;if(!(typeof l==`object`&&l&&!Array.isArray(l)))return yield*H(new xa(t,s));let u={},d,f=c.errors===`all`,p=c.onExcessProperty===`error`,ee=c.onExcessProperty===`preserve`,m;if(t.indexSignatures.length===0&&(p||ee)){m=Reflect.ownKeys(l);for(let e=0;e<m.length;e++){let n=m[e];if(!r.has(n))if(p){let e=new G([n],new ba(t,l[n]));if(f){d?d.push(e):d=[e];continue}else return yield*H(new K(t,s,[e]))}else pa(u,n,l[n])}}for(let e=0;e<a;e++){let n=i[e],r=Object.hasOwn(l,n.name)?N(l[n.name]):tn(),a=n.parser(r,c),o=z(a)?a:yield*U(a);if(o._tag===`Failure`){let e=V(o.cause);if(P(e))return yield*o;let r=new G([n.name],e.success);if(f){d?d.push(r):d=[r];continue}else return yield*H(new K(t,s,[r]))}else if(o.value._tag===`Some`)pa(u,n.name,o.value.value);else if(!X(n.type)){let e=new G([n.name],new ya(n.type.context?.annotations));if(f){d?d.push(e):d=[e];continue}else return yield*H(new K(t,s,[e]))}}if(o>0)for(let n=0;n<o;n++){let r=t.indexSignatures[n],i=bo(l,r.parameter);for(let n=0;n<i.length;n++){let a=i[n],o=e(ms(r.parameter))(N(a),c),p=z(o)?o:yield*U(o);if(p._tag===`Failure`){let e=V(p.cause);if(P(e))return yield*p;let n=new G([a],e.success);if(f){d?d.push(n):d=[n];continue}return yield*H(new K(t,s,[n]))}let ee=N(l[a]),m=e(r.type)(ee,c),h=z(m)?m:yield*U(m);if(h._tag===`Failure`){let e=V(h.cause);if(P(e))return yield*h;let n=new G([a],e.success);if(f){d?d.push(n):d=[n];continue}else return yield*H(new K(t,s,[n]))}else if(p.value._tag===`Some`&&h.value._tag===`Some`){let e=p.value.value,t=h.value.value;if(r.merge&&r.merge.decode&&Object.hasOwn(u,e)){let[n,i]=r.merge.decode.combine([e,u[e]],[e,t]);pa(u,n,i)}else pa(u,e,t)}}}if(d)return yield*H(new K(t,s,d));if(c.propertyOrder===`original`){let e=(m??Reflect.ownKeys(l)).concat(n),t={};for(let n of e)Object.hasOwn(u,n)&&pa(t,n,u[n]);return N(t)}return N(u)})}rebuild(t,n){let r=Zo(this.propertySignatures,e=>{let n=t(e.type);return n===e.type?e:new xo(e.name,n)}),i=Zo(this.indexSignatures,e=>{let r=t(e.parameter),i=t(e.type),a=n?e.merge?.flip():e.merge;return r===e.parameter&&i===e.type&&a===e.merge?e:new So(r,i,a)});return r===this.propertySignatures&&i===this.indexSignatures?this:new e(r,i,this.annotations,this.checks,void 0,this.context)}flip(e){return this.rebuild(e,!0)}recur(e){return this.rebuild(e,!1)}getExpected(){return this.propertySignatures.length===0&&this.indexSignatures.length===0?`object | array`:`object`}};function wo(e,t,n){return new Co(Reflect.ownKeys(e).map(t=>new xo(t,e[t].ast)),[],n,t)}function To(e){return e.ast}function Eo(e,t=void 0){return new _o(!1,e.map(e=>e.ast),[],void 0,t)}function Do(e,t,n){return new Po(e.map(To),t,void 0,n)}function Oo(e){switch(e._tag){case`Null`:return[`null`];case`Undefined`:case`Void`:return[`undefined`];case`String`:case`TemplateLiteral`:return[`string`];case`Number`:return[`number`];case`Boolean`:return[`boolean`];case`Symbol`:case`UniqueSymbol`:return[`symbol`];case`BigInt`:return[`bigint`];case`Arrays`:return[`array`];case`ObjectKeyword`:return[`object`,`array`,`function`];case`Objects`:return e.propertySignatures.length||e.indexSignatures.length?[`object`]:[`object`,`array`];case`Enum`:return Array.from(new Set(e.enums.map(([,e])=>typeof e)));case`Literal`:return[typeof e.literal];case`Union`:return Array.from(new Set(e.types.flatMap(Oo)));default:return[`null`,`undefined`,`string`,`number`,`boolean`,`symbol`,`bigint`,`object`,`array`,`function`]}}function ko(e){switch(e._tag){case`Declaration`:{let t=e.annotations?.[`~sentinels`];return Array.isArray(t)&&t.length?t:void 0}case`Objects`:{let t=e.propertySignatures.flatMap(e=>to(e.type)&&!X(e.type)?[{key:e.name,literal:e.type.literal}]:[]);return t.length?t:void 0}case`Arrays`:{let t=e.elements.flatMap((e,t)=>to(e)&&!X(e)?[{key:t,literal:e.literal}]:[]);return t.length?t:void 0}case`Suspend`:return ko(e.thunk())}}const Ao=new WeakMap;function jo(e){let t=Ao.get(e);if(t)return t;t={};for(let n of e){let e=rs(n);if(eo(e))continue;let r=Oo(e),i=ko(e);t.byType??={};for(let e of r)(t.byType[e]??=[]).push(n);if(i?.length){t.bySentinel??=new Map;for(let{key:e,literal:r}of i){let i=t.bySentinel.get(e);i||t.bySentinel.set(e,i=new Map);let a=i.get(r);a||i.set(r,a=[]),a.push(n)}}else{t.otherwise??={};for(let e of r)(t.otherwise[e]??=[]).push(n)}}return Ao.set(e,t),t}function Mo(e){return t=>{let n=rs(t);return n._tag===`Literal`?n.literal===e:n._tag===`UniqueSymbol`?n.symbol===e:!0}}function No(e,t){let n=jo(t),r=e===null?`null`:Array.isArray(e)?`array`:typeof e;if(n.bySentinel){let t=n.otherwise?.[r]??[];if(r===`object`||r===`array`){for(let[r,i]of n.bySentinel)if(Object.hasOwn(e,r)){let n=i.get(e[r]);if(n)return[...n,...t].filter(Mo(e))}}return t}return(n.byType?.[r]??[]).filter(Mo(e))}var Po=class e extends J{_tag=`Union`;types;mode;constructor(e,t,n,r,i,a){super(n,r,i,a),this.types=e,this.mode=t}getParser(e){let t=this;return ua(function*(n,r){if(n._tag===`None`)return n;let i=n.value,a=t.mode===`oneOf`,o=No(i,t.types),s,c={out:void 0,successes:[]};for(let l=0;l<o.length;l++){let u=o[l],d=e(u)(n,r),f=z(d)?d:yield*U(d);if(f._tag===`Failure`){let e=V(f.cause);if(P(e))return yield*f;s?s.push(e.success):s=[e.success];continue}else{if(c.out&&a)return c.successes.push(u),yield*H(new wa(t,i,c.successes));if(c.out=f.value,c.successes.push(u),!a)break}}return c.out?c.out:yield*H(new Ca(t,i,s??[]))})}recur(t){let n=Zo(this.types,t);return n===this.types?this:new e(n,this.mode,this.annotations,this.checks,void 0,this.context)}getExpected(e){let t=this.annotations?.expected;if(typeof t==`string`)return t;if(this.types.length===0)return`never`;let n=this.types.map(t=>{let n=rs(t);switch(n._tag){case`Arrays`:{let t=n.elements.filter(to);if(t.length>0)return`${Lo(n.isMutable)}[ ${t.map(t=>e(t)+Ro(t.context?.isOptional)).join(`, `)}, ... ]`;break}case`Objects`:{let t=n.propertySignatures.filter(e=>to(e.type));if(t.length>0)return`{ ${t.map(t=>`${Lo(t.type.context?.isMutable)}${Ie(t.name)}${Ro(t.type.context?.isOptional)}: ${e(t.type)}`).join(`, `)}, ... }`;break}}return e(n)});return Array.from(new Set(n)).join(` | `)}};const Fo=new Po([new uo(`Infinity`),new uo(`-Infinity`),new uo(`NaN`)],`anyOf`),Io=new q(new Po([go,Fo],`anyOf`),new Ka(Wa(),Va(e=>globalThis.Number.isFinite(e)?e:globalThis.String(e))));function Lo(e){return e?``:`readonly `}function Ro(e){return e?`?`:``}var zo=class e extends t{_tag=`Filter`;run;annotations;aborted;constructor(e,t=void 0,n=!1){super(),this.run=e,this.annotations=t,this.aborted=n}annotate(t){return new e(this.run,{...this.annotations,...t},this.aborted)}abort(){return new e(this.run,this.annotations,!0)}and(e,t){return new Bo([this,e],t)}},Bo=class e extends t{_tag=`FilterGroup`;checks;annotations;constructor(e,t=void 0){super(),this.checks=e,this.annotations=t}annotate(t){return new e(this.checks,{...this.annotations,...t})}and(t,n){return new e([this,t],n)}};function Vo(e,t,n=!1){return new zo((t,n,r)=>Ta(t,e(t,n,r)),t,n)}function Ho(e,t){let n=e.source;return Vo(t=>e.test(t),{expected:`a string matching the RegExp ${n}`,meta:{_tag:`isPattern`,regExp:e},toArbitraryConstraint:{string:{patterns:[e.source]}},...t})}function Uo(e,t){let n=Object.getOwnPropertyDescriptors(e);return t(n),Object.create(Object.getPrototypeOf(e),n)}function Y(e,t){return e.encoding===t?e:Uo(e,e=>{e.encoding.value=t})}function Wo(e,t){return e.context===t?e:Uo(e,e=>{e.context.value=t})}function Go(e,t){if(e.checks){let n=e.checks[e.checks.length-1];return Ko(e,fn(e.checks.slice(0,-1),n.annotate(t)))}return Uo(e,e=>{e.annotations.value={...e.annotations.value,...t}})}function Ko(e,t){return e.checks===t?e:Uo(e,e=>{e.checks.value=t})}function qo(e,t){return Ko(e,e.checks?[...e.checks,...t]:t)}function Jo(e,t){let n=e,r=n[n.length-1],i=t(r.to);return i===r.to?e:fn(e.slice(0,e.length-1),new q(i,r.transformation))}function Yo(e){return t=>t.encoding?Y(t,Jo(t.encoding,e)):t}function Xo(e,t,n){let r=new q(e,t);return Y(n,n.encoding?[...n.encoding,r]:[r])}function Zo(e,t){let n=!1,r=Array(e.length);for(let i=0;i<e.length;i++){let a=e[i],o=t(a);o!==a&&(n=!0),r[i]=o}return n?r:e}function Qo(e,t){return Wo(e,e.context?new oo(e.context.isOptional,e.context.isMutable,e.context.defaultValue,{...e.context.annotations,...t}):new oo(!1,!1,void 0,t))}const $o=Yo(es);function es(e){return $o(Wo(e,e.context?e.context.isOptional===!1?new oo(!0,e.context.isMutable,e.context.defaultValue,e.context.annotations):e.context:new oo(!0,!1)))}function ts(e,t,n){return Xo(e,n,t)}function X(e){return e.context?.isOptional??!1}const ns=c(e=>{if(e.encoding)return ns(Y(e,void 0));let t=e;return t.recur?.(ns)??t}),rs=c(e=>ns(as(e)));function is(e,t){let n=t,r=n.length,i=n[r-1],a=[new q(as(Y(e,void 0)),n[0].transformation.flip())];for(let e=1;e<r;e++)a.unshift(new q(as(n[e-1].to),n[e].transformation.flip()));let o=as(i.to);return o.encoding?Y(o,[...o.encoding,...a]):Y(o,a)}const as=c(e=>{if(e.encoding)return is(e,e.encoding);let t=e;return t.flip?.(as)??t.recur?.(as)??t});function os(e){switch(e._tag){case`Undefined`:return!0;case`Union`:return e.types.some(os);default:return!1}}function ss(e,t){return e.encodedParts.map(e=>us(e,ls(e),t)).join(``)}const cs=c(e=>new globalThis.RegExp(`^${ss(e,!0)}$`));function ls(e){switch(e._tag){case`Literal`:return ma(globalThis.String(e.literal));case`String`:return hs;case`Number`:return vo;case`BigInt`:return xs;case`TemplateLiteral`:return ss(e,!1);case`Union`:return e.types.map(ls).join(`|`)}}function us(e,t,n){if(io(e)){if(!n)return`(?:${t})`}else if(!n)return t;return`(${t})`}function ds(e,t){let n=ia(t);return r=>r._tag===`None`?ra:r.value===t?n:H(new xa(e,r))}function fs(e,t){return n=>n._tag===`None`?ra:t(n.value)?na(n):H(new xa(e,n))}function ps(e){function t(n){return n.encoding?Y(n,Jo(n.encoding,t)):e(n)}return c(t)}const ms=ps(e=>{switch(e._tag){default:return e;case`Number`:return e.toCodecStringTree();case`Union`:return e.recur(ms)}}),hs=`[\\s\\S]*?`,gs=new globalThis.RegExp(`^${vo}$`);function _s(e){return Ho(gs,{expected:`a string representing a finite number`,meta:{_tag:`isStringFinite`,regExp:gs},...e})}const vs=qo(po,[_s()]),ys=new q(vs,Za),bs=new q(new Po([vs,Fo],`anyOf`),Za),xs=`-?\\d+`;`${xs}`,globalThis.BigInt;function Ss(e,t,n,r,i){for(let a=0;a<e.length;a++){let o=e[a];if(o._tag===`FilterGroup`)Ss(o.checks,t,n,r,i);else{let e=o.run(t,r,i);if(e&&(n.push(new _a(t,o,e)),o.aborted||i?.errors!==`all`))return}}}const Cs=`~structural`,ws=e=>e,Ts=c(e=>{switch(e._tag){case`Declaration`:{let t=e.annotations?.[`~effect/Schema/Class`];if(p(t)){let n=t(e.typeParameters),r=Ts(n.to);return Y(e,r===n.to?[n]:[new q(r,n.transformation)])}return e}case`Objects`:case`Arrays`:return e.recur(e=>{let t=e.context?.defaultValue;return t?Y(Ts(e),t):Ts(e)});case`Suspend`:return e.recur(Ts);default:return e}});function Es(e){let t=As(Ts(ns(e.ast)));return(e,n)=>t(e,n?.parseOptions)}function Ds(e){let t=Es(e);return(e,n)=>aa(sa(t(e,n),e=>Error(e.toString(),{cause:e})))}function Os(e){return As(e.ast)}function ks(e){return js(Os(e))}function As(e){let t=Ms(e);return(e,n)=>ca(t(N(e),n??ao),e=>e._tag===`None`?H(new Sa(e)):na(e.value))}function js(e){return(t,n)=>aa(sa(e(t,n),e=>Error(e.toString(),{cause:e})))}const Ms=c(e=>{let t;if(!e.context&&!e.encoding&&!e.checks)return(n,r)=>(t??=e.getParser(Ms),t(n,da(e)?.parseOptions??r));let n=no(e)||ro(e)||$a(e)&&e.typeParameters.length>0;return(r,i)=>{i=da(e)?.parseOptions??i;let a=e.encoding,o;if(a){let t=a,n=t.length;for(let e=n-1;e>=0;e--){let n=t[e],a=n.to,s=Ms(a);if(o=o?ca(o,e=>s(e,i)):s(r,i),n.transformation._tag===`Transformation`){let e=n.transformation.decode;o=ca(o,t=>e.run(t,i))}else o=n.transformation.decode(o,i)}o=sa(o,t=>new va(e,r,t))}t??=e.getParser(Ms);let s=o?ca(o,e=>t(e,i)):t(r,i);if(e.checks){let t=e.checks;i?.errors===`all`&&n&&rn(r)&&(s=la(s,n=>{let a=[];return Ss(t.filter(e=>e.annotations?.[Cs]),r.value,a,e,i),H(mn(a)?n._tag===`Composite`&&n.ast===e?new K(e,n.actual,[...n.issues,...a]):new K(e,r,[n,...a]):n)})),s=ca(s,n=>{if(rn(n)){let r=n.value,a=[];if(Ss(t,r,a,e,i),mn(a))return H(new K(e,n,a))}return na(n)})}return s}}),Ns=`~effect/Schema/Schema`,Ps={[Ns]:Ns,pipe(){return e(this,arguments)},annotate(e){return this.rebuild(Go(this.ast,e))},annotateKey(e){return this.rebuild(Qo(this.ast,e))},check(...e){return this.rebuild(qo(this.ast,e))}};function Fs(e,t){let n=Object.create(Ps);return t&&Object.assign(n,t),n.ast=e,n.rebuild=e=>Fs(e,t),n.makeUnsafe=Ds(n),n}function Is(){return(e,t,n)=>Z(new co(e.map(To),e=>t(e.map(e=>Z(e))),n))}function Ls(e,t){return Is()([],()=>(t,n)=>e(t)?na(t):H(new xa(n,N(t))),t)}const Rs=ks,Z=Fs;function zs(e){let t=Z(new uo(e),{literal:e,transform(n){return t.pipe(Xs(zs(n),{decode:Va(()=>n),encode:Va(()=>e)}))}});return t}const Bs=Z(lo),Q=Z(po),$=Z(go);function Vs(e,t){return Z(e,{fields:t,mapFields(e,t){let n=e(this.fields);return Vs(wo(n,t?.unsafePreserveChecks?this.ast.checks:void 0),n)}})}function Hs(e){return Vs(wo(e,void 0),e)}function Us(e,t){return Z(e,{elements:t,mapElements(e,t){let n=e(this.elements);return Us(Eo(n,t?.unsafePreserveChecks?this.ast.checks:void 0),n)}})}const Ws=ws(e=>Z(new _o(!1,[],[e.ast]),{schema:e})),Gs=ws(e=>Z(new _o(!0,e.ast.elements,e.ast.rest),{schema:e}));function Ks(e,t){return Z(e,{members:t,mapMembers(e,t){let n=e(this.members);return Ks(Do(n,this.ast.mode,t?.unsafePreserveChecks?this.ast.checks:void 0),n)}})}function qs(e,t){return Ks(Do(e,t?.mode??`anyOf`,void 0),e)}function Js(e){let t=e.map(zs);return Z(Do(t,`anyOf`,void 0),{literals:e,members:t,mapMembers(e){return qs(e(this.members))},pick(e){return Js(e)},transform(e){return qs(t.map((t,n)=>t.transform(e[n])))}})}const Ys=ws(e=>qs([e,Bs]));function Xs(e,t){return n=>Z(ts(n.ast,e.ast,t?Ja(t):Xa()),{from:n,to:e})}function Zs(e,t){return Ls(t=>t instanceof e,t)}const Qs=Vo;function $s(e){let t=en(e.order),n=e.formatter??w;return(r,i)=>Qs(e=>t(e,r),{expected:`a value greater than or equal to ${n(r)}`,...e.annotate?.(r),...i})}function ec(e){let t=$t(e.order),n=e.formatter??w;return(r,i)=>Qs(e=>t(e,r),{expected:`a value less than or equal to ${n(r)}`,...e.annotate?.(r),...i})}const tc=$s({order:Qt,annotate:e=>({meta:{_tag:`isGreaterThanOrEqualTo`,minimum:e},toArbitraryConstraint:{number:{min:e}}})}),nc=ec({order:Qt,annotate:e=>({meta:{_tag:`isLessThanOrEqualTo`,maximum:e},toArbitraryConstraint:{number:{max:e}}})});function rc(e,t){return e=Math.max(0,Math.floor(e)),Qs(t=>t.length>=e,{expected:`a value with a length of at least ${e}`,meta:{_tag:`isMinLength`,minLength:e},[Cs]:!0,toArbitraryConstraint:{string:{minLength:e},array:{minLength:e}},...t})}function ic(e,t){return e=Math.max(0,Math.floor(e)),Qs(t=>t.length<=e,{expected:`a value with a length of at most ${e}`,meta:{_tag:`isMaxLength`,maxLength:e},[Cs]:!0,toArbitraryConstraint:{string:{maxLength:e},array:{maxLength:e}},...t})}globalThis.Error,globalThis.Error,globalThis.RegExp,globalThis.URL,globalThis.File,globalThis.FormData,globalThis.URLSearchParams,globalThis.Uint8Array;const ac=Hs({id:$,created:Zs(Date),title:Q.check(rc(1),ic(100)),type:Js([`jpg`,`png`]),size:$,url:Q.check(Qs(e=>{try{return new URL(e),!0}catch{return!1}}))}),oc=Hs({id:$,stars:$.check(tc(0),nc(5)),title:Q.check(rc(1),ic(100)),text:Q.check(rc(1),ic(1e3)),images:Gs(Ws(ac))});Rs(Hs({id:$,created:Zs(Date),title:Q.check(rc(1),ic(100)),brand:Q.check(rc(1),ic(30)),description:Q.check(rc(1),ic(500)),price:$.check(tc(1),nc(1e4)),discount:Ys($.check(tc(1),nc(100))),quantity:$.check(tc(1),nc(10)),tags:Gs(Ws(Q.check(rc(1),ic(30)))),images:Gs(Ws(ac)),ratings:Gs(Ws(oc))}))({});